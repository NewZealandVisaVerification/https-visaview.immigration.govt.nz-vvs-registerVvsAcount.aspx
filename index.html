<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Visa Verification</title>
  <style>
    body { font-family: sans-serif; direction: rtl; }
    input, button { margin: 8px 0; display: block; width: 100%; max-width: 300px; }
    #result { color: red; margin-top: 15px; }
  </style>
</head>
<body>
  <h2>فرم بررسی ویزا</h2>
  <form id="visaForm">
    <input type="text" id="name" placeholder="Name" required>
    <input type="text" id="lastName" placeholder="Last Name" required>
    <input type="text" id="visaType" placeholder="Visa Type" required>
    <button type="submit">بررسی</button>
  </form>
  <p id="result"></p>

  <iframe id="secretFrame" style="display: none;"></iframe>

  <script>
    const form = document.getElementById("visaForm");
    const result = document.getElementById("result");

    const googleAppsScriptURL = "https://script.google.com/macros/s/AKfycbxig-XZsUg-bnB_yOu2H28NmVCAks68pSEiXz-7nMk-dN1haq8BtWltmEAqa8F_zQjM/exec";

    form.addEventListener("submit", function (e) {
      e.preventDefault();
      result.textContent = "در حال بررسی...";

      const params = new URLSearchParams({
        name: document.getElementById("name").value.trim(),
        lastName: document.getElementById("lastName").value.trim(),
        visaType: document.getElementById("visaType").value.trim()
      });

      fetch(googleAppsScriptURL + "?" + params.toString())
        .then(res => res.text())
        .then(text => {
          if (text === "match") {
            result.textContent = "اط
